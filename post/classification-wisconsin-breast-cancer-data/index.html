<!DOCTYPE html>
<html lang="en-uk">
<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<script type="application/ld+json">
    {
        "@context" : "http://schema.org",
        "@type" : "BlogPosting",
        "mainEntityOfPage": {
             "@type": "WebPage",
             "@id": "https://datk12.github.io"
        },
        "articleSection" : "post",
        "name" : "Classification - Wisconsin Breast Cancer Data",
        "headline" : "Classification - Wisconsin Breast Cancer Data",
        "description" : "Today I will be looking at the Wisconsin Breast Cancer Data Set a pre-processed, clean data set on SKLearn. The purpose of this is to classify whether the tumour is ‘benign’ or ‘malignant’ and I will be comparing and contrasting a number of different techniques as a means of understanding the data. As this is a relatively small data set, I don&rsquo;t foresee any meaningful difference in the models&rsquo; power of prediciton.",
        "inLanguage" : "en",
        "author" : "",
        "creator" : "",
        "publisher": "",
        "accountablePerson" : "",
        "copyrightHolder" : "",
        "copyrightYear" : "2019",
        "datePublished": "2019-03-14 11:37:00 &#43;0000 UTC",
        "dateModified" : "2019-03-14 11:37:00 &#43;0000 UTC",
        "url" : "https://datk12.github.io/post/classification-wisconsin-breast-cancer-data/",
        "wordCount" : "1003",
        "image" : https://datk12.github.ioimg/portfolio/uni_wisc.jpg",
        "keywords" : [ "Logistic Regression","Random Forest Regressor","Wisconsin Breat Cancer","Blog" ]   
    }
    </script>


 <title>Classification - Wisconsin Breast Cancer Data </title>


<meta name="description" content="" />



<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="robots" content="all,follow">
<meta name="googlebot" content="index,follow,snippet,archive">
<link rel="stylesheet" id="ct-tracks-google-fonts-css" href="//fonts.googleapis.com/css?family=Raleway%3A400%2C700&amp;subset=latin%2Clatin-ext&amp;ver=4.7.2" type="text/css" media="all">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">

<link href="https://datk12.github.io/css/style.css?v=1555324179" rel="stylesheet" id="theme-stylesheet" type='text/css' media='all'>

<link href="https://datk12.github.io/css/custom.css?v=1555324179" rel="stylesheet" type='text/css' media='all'>
<link rel="shortcut icon" href="https://datk12.github.io/img/favicon.ico" type="image/x-icon">
<link rel="icon" href="https://datk12.github.io/img/favicon.ico" type="image/x-icon">


</head>


<body class="post-template-default single single-post single-format-standard ct-body singular singular-post not-front standard">

  <div id="overflow-container" class="overflow-container">
    <a class="skip-content" href="#main">Skip to content</a>
    <header id="site-header" class="site-header" role="banner">
      <div class='top-navigation'>
        <div class='container'>

  <div id="menu-secondary" class="menu-container menu-secondary" role="navigation">
    <button id="toggle-secondary-navigation" class="toggle-secondary-navigation"><i class="fas fa-plus"></i></button>

    <div class="menu">

      <ul id="menu-secondary-items" class="menu-secondary-items">
        
        <li id="menu-item" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item">
          <a href="/categories/linear-regression">linear-regression</a>
        </li>
        
        <li id="menu-item" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item">
          <a href="/categories/logistic-regression">logistic-regression</a>
        </li>
        
        <li id="menu-item" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item">
          <a href="/categories/nlp">nlp</a>
        </li>
        
        <li id="menu-item" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item">
          <a href="/categories/random-forest-regressor">random-forest-regressor</a>
        </li>
        
        <li id="menu-item" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item">
          <a href="/categories/scrapy">scrapy</a>
        </li>
        
        <li id="menu-item" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item">
          <a href="/categories/spacy">spacy</a>
        </li>
        

      </ul>

    </div>

  </div>


  <ul class="social-media-icons">


    

    

    

    

    

    

    


    


    

    


  </ul></div>

      </div>

      <div class="container">
        <div id="title-info" class="title-info">
  <div id='site-title' class='site-title'>
    
    <a href="/"> Dom Atkinson </a>
    </div>
  </div>
  <button id="toggle-navigation" class="toggle-navigation">
    <i class="fas fa-bars"></i>
  </button>

  <div id="menu-primary-tracks" class="menu-primary-tracks"></div>
  <div id="menu-primary" class="menu-container menu-primary" role="navigation">
    

    <div class="menu">
      <ul id="menu-primary-items" class="menu-primary-items">
        
        
        <li id="menu-item" class='menu-item menu-item-type-custom menu-item-object-custom '>
          <a href="https://datk12.github.io/">Home</a>
          
        </li>
        
        <li id="menu-item" class='menu-item menu-item-type-post_type menu-item-object-page '>
          <a href="https://datk12.github.io/about/">About</a>
          
        </li>
        
      </ul>
    </div>

  </div>

      </div>
    </header>

    <div id="main" class="main" role="main">

      
  
  
    
  
  
  <div id="loop-container" class="loop-container">
    
    <div class="post type-post status-publish format-standard has-post-thumbnail hentry category-design tag-design tag-standard-2 tag-tagalicious tag-travel entry full-without-featured odd excerpt-1">

      <div class='featured-image lazy lazy-bg-image'  data-background="https://datk12.github.io/img/portfolio/uni_wisc.jpg">
      </div>
      
        <div class="entry-meta">
          <span class="date">14 March</span>	<span> / </span>

          <span class="author">
            <a href="https://datk12.github.io" title="Posts by Dom Atkinson" rel="author">Dom Atkinson</a>
          </span>


          
          <span class="category">
            <span> / </span>

            <a href="/categories/logistic-regression">Logistic Regression</a>
          </span>
          
          <span class="category">
            <span> / </span>

            <a href="/categories/random-forest-regressor">Random Forest Regressor</a>
          </span>
          


        </div>
        <div class='entry-header'>
          <h1 class='entry-title'> Classification - Wisconsin Breast Cancer Data</h1>
        </div>
        <div class="entry-container">
          <div class="entry-content">
            <article>
              <p>Today I will be looking at the Wisconsin Breast Cancer Data Set a pre-processed, clean data set on SKLearn. The purpose of this is to classify whether the tumour is ‘benign’ or ‘malignant’ and I will be comparing and contrasting a number of different techniques as a means of understanding the data. As this is a relatively small data set, I don&rsquo;t foresee any meaningful difference in the models&rsquo; power of prediciton. However, this should provide an insight into some of the different tools and metrics available.</p>

<p>A brief exploration of the data:</p>

<p><img src="/img/wis/wis_1.png" alt="wis 1" />
<img src="/img/wis/wis_2.png" alt="wis 2" />
<img src="/img/wis/wis_3.png" alt="wis 3" /></p>

<p>As mentioned in the description, this is a data set of 30 numerical values. These features are computed from a digitized image of a fine needle aspirate (FNA) of a breast mass. They describe characteristics of the cell nuclei present in the image.</p>

<p><img src="/img/wis/wis_hist.png" alt="wis hist" /></p>

<p>Here is confirmation that we have a binary target (1,0) corresponding to ‘benign’ or ‘malignant’.</p>

<p><img src="/img/wis/wis_target_confirmation.png" alt="wis target confirmation" /></p>

<p>That shows a slight skew towards &lsquo;benign&rsquo; (1).</p>

<p><img src="/img/wis/wis_ben_count.png" alt="wis ben count" /></p>

<p>Now let’s split the data and fit it to a Logistic Regression and evaluate its appropriateness. The .score() method returns the mean accuracy on the given test data and labels.</p>

<p><img src="/img/wis/wis_log_split.png" alt="wis log split" /></p>

<p>We also run a cross_val_score() on the training data with 3 folds. This splits the data into 3 folds, makes a prediction on each fold and evaluates each fold using a mini-model trained on the remaining folds. As this is a binary classification problem (i.e ‘benign’ or ‘malignant’), this fits the bill, though in cases where you are trying to solve a multiclass classification problem or if there is significant skew amongst classes, this may not be appropriate. In this case, there is a slight skew, with ‘benign’ instances making up 63% of the data. Imbalanced classification is fairly common in disease detection, where typically most of the data points are negative. In such cases, accuracy is not a good measure of model performance.</p>

<p><img src="/img/wis/wis_log_cross_val_pred.png" alt="wis cross val pred" /></p>

<p>Cross_val_predict() does the same as cross_val_score, but returns the predictions made on each fold.</p>

<p><img src="/img/wis/wis_log_conf.png" alt="wis log conf" /></p>

<p>This is necessary if we want to evaluate the model using a confusion matrix. The rows in the confusion matrix represent the classes. Correct predictions run across the main diagonal, from top left to bottom right. In this case the top row is the negative class (i.e 0 or ‘malignant’), while the columns represent the predictions. So, the value on the top left pertains to true negative, or a correct prediction of the negative class. To the top right is false negative, or an incorrect prediction of ‘malign’. Below, the wrongly predicted positives or false positives, meaning the incorrect predictions of benign are on the left. While on the right, the value represents true positives, or correct ‘benign’ predictions.</p>

<p>These can be computed into ratios in the form of Precision and Recall. Both of these metrics can be found in the confusion matrix but emphasise different factors.</p>

<p><img src="/img/wis/wis_log_rec.png" alt="wis log rec" /></p>

<p>Recall is all True Positives divided by all True Positives + all False Negatives. In this case, it is the number of True Positives (correctly predicted instances of ‘benign’), divided by True Positives + False Negatives (incorrect predictions of ‘malignant’, i.e actually ‘benign’).</p>

<p><img src="/img/wis/wis_log_prec.png" alt="wis log prec" /></p>

<p>Whereas, Precision refers to True Positives, divided by True Positives (correctly predicted instances of ‘benign’) + False Positives (incorrect predictions of ‘benign’, i.e actually ‘malignant’).</p>

<p>As can be intuited, these is generally a trade-off between Precision and Recall. If we incorrectly labelled all results as ‘benign’, we would have a perfect Recall, but an atrocious Precision. Recall can be thought of as a model’s ability to find all relevant instances in a dataset, whereas Precision can be thought of as the proportion of data points the model suggests is relevant that actually are.</p>

<p><img src="/img/wis/wis_log_f1.png" alt="wis log f1" /></p>

<p>In this case, there is a marginal difference and the scores are quite high, suggesting the model is appropriate. They can be combined, into the F1 score.</p>

<p>Another way of evaluating the appropriateness of the findings is to plot the True Positive Rate (recall) vs. the False Positive Rate (ratio of negatives predictions incorrectly classified as positive). The ROC plots this function. In a perfect case, both TPR and FPR would be 1, while a perfectly random model would produce 0.5.</p>

<p><img src="/img/wis/wis_log_roc.png" alt="wis log roc" />
<img src="/img/wis/wis_log_roc_score.png" alt="wis log roc score" /></p>

<p>Next, we do the same for a Random Forrest Regressor. This is a more flexible model, so it is perhaps understandable that it has a higher accuracy for the training data.</p>

<p><img src="/img/wis/wis_rf_fit.png" alt="wis rf fit" /></p>

<p>The danger here, of course, is that the model overfits to the training data and generalises patterns unique to the training set onto the test set. This is where cross_val_score() becomes more important, as it allows us to train and evaluate a number of models on a limited training set. With a total data set of only 569, in reality, overfitting with a model of this type is very probable. Unsurprisingly, this model produces a better score on the training data.</p>

<p>We can see little meaningful difference in the evaluation metrics between the models.</p>

<p><img src="/img/wis/wis_rf_prec_rec_f1.png" alt="wis rf prec rec f1" />
<img src="/img/wis/wis_rf_cof.png" alt="wis rf cof" />
<img src="/img/wis/wis_rf_roc.png" alt="wis rf roc" />
<img src="/img/wis/wis_rf_roc_score.png" alt="wis rf roc score" /></p>

<p>With such a small data set, any optimisation would appear meaningless, as there is little defence against overfitting. Indeed, the Random Forest Classifier predicted 100% accuracy on the training data.</p>

<p>It is conceivable that in a medical setting, it would be in the interest of doctors to idetnfy the features that had the highest predictive power. If a test could be conducted at a lower of the price with only a slightly worse accuracy, it may be preferable for a hospital to use. Of course, in the real world there would be a whole host of ethical questions to consider, but the principle could be applied to any number of problems. One would hope that more data was available as a precaution against overfitting on the training data. For our purposes, though, it is interest enough to play with some of the tools.</p>

<p>Helpfully, the SKLearn Random Forest Regressor class has a feature importance method.</p>

<p><img src="/img/wis/wis_feature_fit.png" alt="wis feature fit" /></p>

<p>After which it is fairly simple to look at.</p>

<p><img src="/img/wis/wis_feature_imp_list.png" alt="wis feature imp list" /></p>

<p>And to graph.</p>

<p><img src="/img/wis/wis_feature_graph.png" alt="wis feature graph" /></p>

<p>If we then pass the five most important features through a box plot, they show a clear skew towards malignant.</p>

<p><img src="/img/wis/wis_worstp_box.png" alt="wis worstp_box" />
<img src="/img/wis/wis_worstcp_box.png" alt="wis worstp_box" />
<img src="/img/wis/wis_worstr_box.png" alt="wis worstr_box" />
<img src="/img/wis/wis_meancp_box.png" alt="wis meancp box" />
<img src="/img/wis/wis_mean_conc_box.png" alt="wis mean conc box" /></p>

            </article>
          </div>
          
      <div class='entry-meta-bottom'>
        

  <div class="entry-categories"><p><span>Categories</span>
    
    <a href="/categories/logistic-regression" title="View all posts in Logistic Regression">Logistic Regression</a>
    <a href="/categories/random-forest-regressor" title="View all posts in Random Forest Regressor">Random Forest Regressor</a>
  </p>
</div>



<div class="entry-tags"><p><span>Tags</span>
  
  <a href="/tags/logistic-regression" title="View all posts tagged Logistic Regression">Logistic Regression</a>
  
  <a href="/tags/random-forest-regressor" title="View all posts tagged Random Forest Regressor">Random Forest Regressor</a>
  
  <a href="/tags/wisconsin-breat-cancer" title="View all posts tagged Wisconsin Breat Cancer">Wisconsin Breat Cancer</a>
  

</p></div>	</div>

	
</div>
</div>

<section id="comments" class="comments">
  

  




</section>
</div>

 



    </div>

    <footer id="site-footer" class="site-footer" role="contentinfo">
	<h1>
    
    <a href=""> Dom Atkinson </a>
    
	</h1>

			

		<div id="menu-footer" class="menu-container menu-footer" role="navigation">
		<div class="menu">

      <ul id="menu-footer-items" class="menu-footer-items">
        
</ul>

</div>	</div>

<ul class="social-media-icons">

        

        


        

        

        

        

        


        


        

        

				</ul>	<div class="design-credit">
		
		<p>
			Nederburg Hugo Theme by <a target="_blank" href="https://appernetic.io">Appernetic</a>.
		</p>
		<p>
			A port of Tracks by Compete Themes.
		</p>
		
	</div>
</footer>

  </div>
  <script src="https://datk12.github.io/js/jquery.min.js"></script>
<script src="https://datk12.github.io/js/jquerymigrate.js"></script>
<script src="https://datk12.github.io/js/production.min.js?v=1555324179"></script>

</body>
</html>
